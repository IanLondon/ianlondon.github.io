<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.13.3"/><style data-href="/styles.a5e48f8eedcacdc2c2a4.css" data-identity="gatsby-global-css">/*
! tailwindcss v3.4.1 | MIT License | https://tailwindcss.com
*/*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:""}:host,html{-webkit-text-size-adjust:100%;font-feature-settings:normal;-webkit-tap-highlight-color:transparent;font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-variation-settings:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-feature-settings:normal;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em;font-variation-settings:normal}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{font-feature-settings:inherit;color:inherit;font-family:inherit;font-size:100%;font-variation-settings:inherit;font-weight:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]{display:none}*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }.static{position:static}.relative{position:relative}.sticky{position:sticky}.top-4{top:1rem}.m-auto{margin:auto}.my-2{margin-bottom:.5rem;margin-top:.5rem}.my-4{margin-top:1rem}.mb-4,.my-4{margin-bottom:1rem}.block{display:block}.flex{display:flex}.h-full{height:100%}.w-32{width:8rem}.w-full{width:100%}.max-w-4xl{max-width:56rem}.basis-1\/4{flex-basis:25%}.flex-col{flex-direction:column}.justify-between{justify-content:space-between}.rounded-full{border-radius:9999px}.rounded-md{border-radius:.375rem}.bg-amber-900{--tw-bg-opacity:1;background-color:rgb(120 53 15/var(--tw-bg-opacity))}.bg-amber-950{--tw-bg-opacity:1;background-color:rgb(69 26 3/var(--tw-bg-opacity))}.bg-stone-900{--tw-bg-opacity:1;background-color:rgb(28 25 23/var(--tw-bg-opacity))}.p-3{padding:.75rem}.p-4{padding:1rem}.py-2{padding-bottom:.5rem;padding-top:.5rem}.text-center{text-align:center}.text-3xl{font-size:1.875rem;line-height:2.25rem}.font-semibold{font-weight:600}.italic{font-style:italic}.text-amber-100{--tw-text-opacity:1;color:rgb(254 243 199/var(--tw-text-opacity))}.markdown{font-size:.875rem;line-height:1.25rem;line-height:1.625}@media (min-width:640px){.markdown{font-size:1rem;line-height:1.5rem}}@media (min-width:1024px){.markdown{font-size:1.125rem;line-height:1.75rem}}.markdown h1,.markdown h2{font-size:1.25rem;font-weight:600;line-height:1.75rem;margin-bottom:1.5rem;margin-top:1.5rem}.markdown h3,.markdown h4,.markdown h5,.markdown h6{font-size:1.125rem;font-weight:600;line-height:1.75rem;margin-bottom:.75rem;margin-top:.75rem}@media (min-width:640px){.markdown h1,.markdown h2{font-size:1.5rem;line-height:2rem}.markdown h3,.markdown h4,.markdown h5,.markdown h6{font-size:1.25rem;line-height:1.75rem}}.markdown a{--tw-text-opacity:1;color:rgb(245 158 11/var(--tw-text-opacity))}.markdown a:hover{text-decoration-line:underline}.markdown p{margin-bottom:1rem}.markdown ol,.markdown ul{margin-bottom:1rem;margin-left:2rem}.markdown li>ol,.markdown li>p,.markdown li>ul{margin-bottom:0}.markdown ol{list-style-type:decimal}.markdown ul{list-style-type:disc}.markdown blockquote{--tw-border-opacity:1;--tw-bg-opacity:1;background-color:rgb(120 53 15/var(--tw-bg-opacity));border-color:rgb(251 191 36/var(--tw-border-opacity));border-left-width:4px;font-style:italic;margin-bottom:1rem;margin-left:1.5rem;margin-right:1.5rem;padding:.5rem}.markdown blockquote>p{margin-bottom:0}.markdown td,.markdown th{--tw-border-opacity:1;border-color:rgb(251 191 36/var(--tw-border-opacity));border-width:1px;padding:.25rem .5rem}.markdown tr:nth-child(odd){--tw-bg-opacity:1;background-color:rgb(146 64 14/var(--tw-bg-opacity))}.markdown table{margin-bottom:1.5rem}.markdown :not(pre)>code.language-text{white-space:pre-line}.markdown code{--tw-text-opacity:1;color:rgb(253 224 71/var(--tw-text-opacity))}.hover\:bg-amber-800:hover{--tw-bg-opacity:1;background-color:rgb(146 64 14/var(--tw-bg-opacity))}.hover\:bg-amber-900:hover{--tw-bg-opacity:1;background-color:rgb(120 53 15/var(--tw-bg-opacity))}.hover\:font-bold:hover{font-weight:700}.hover\:underline:hover{text-decoration-line:underline}@media (min-width:1024px){.lg\:m-auto{margin:auto}.lg\:w-full{width:100%}.lg\:max-w-4xl{max-width:56rem}.lg\:basis-3\/4{flex-basis:75%}.lg\:flex-row{flex-direction:row}.lg\:p-0{padding:0}.lg\:px-12{padding-left:3rem;padding-right:3rem}.lg\:pt-4{padding-top:1rem}}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/><link rel="icon" href="/favicon-32x32.png?v=a3e20b7904612699ef962aa83aaa759b" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=a3e20b7904612699ef962aa83aaa759b"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=a3e20b7904612699ef962aa83aaa759b"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=a3e20b7904612699ef962aa83aaa759b"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=a3e20b7904612699ef962aa83aaa759b"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=a3e20b7904612699ef962aa83aaa759b"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=a3e20b7904612699ef962aa83aaa759b"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=a3e20b7904612699ef962aa83aaa759b"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=a3e20b7904612699ef962aa83aaa759b"/><title data-gatsby-head="true">Ian&#x27;s Projects Blog</title></head><body class="bg-stone-900 text-amber-100 static h-full"><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><main><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained w-full"><div style="max-width:1291px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg%20height=&#x27;968.0000000000001&#x27;%20width=&#x27;1291&#x27;%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#080808;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="/static/c90c97eff262a8d4998abe302e31b837/39aed/splash-banner.webp 323w,/static/c90c97eff262a8d4998abe302e31b837/aa93a/splash-banner.webp 646w,/static/c90c97eff262a8d4998abe302e31b837/e84aa/splash-banner.webp 1291w" sizes="(min-width: 1291px) 1291px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1291px) 1291px, 100vw" decoding="async" loading="lazy" data-src="/static/c90c97eff262a8d4998abe302e31b837/a038c/splash-banner.jpg" data-srcset="/static/c90c97eff262a8d4998abe302e31b837/7d205/splash-banner.jpg 323w,/static/c90c97eff262a8d4998abe302e31b837/297c2/splash-banner.jpg 646w,/static/c90c97eff262a8d4998abe302e31b837/a038c/splash-banner.jpg 1291w" alt="splash image"/></picture><noscript><picture><source type="image/webp" srcSet="/static/c90c97eff262a8d4998abe302e31b837/39aed/splash-banner.webp 323w,/static/c90c97eff262a8d4998abe302e31b837/aa93a/splash-banner.webp 646w,/static/c90c97eff262a8d4998abe302e31b837/e84aa/splash-banner.webp 1291w" sizes="(min-width: 1291px) 1291px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1291px) 1291px, 100vw" decoding="async" loading="lazy" src="/static/c90c97eff262a8d4998abe302e31b837/a038c/splash-banner.jpg" srcSet="/static/c90c97eff262a8d4998abe302e31b837/7d205/splash-banner.jpg 323w,/static/c90c97eff262a8d4998abe302e31b837/297c2/splash-banner.jpg 646w,/static/c90c97eff262a8d4998abe302e31b837/a038c/splash-banner.jpg 1291w" alt="splash image"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div><section class="flex flex-col lg:flex-row"><aside class="basis-1/4 lg:px-12 lg:pt-4 relative"><section class="sticky top-4 lg:p-0 p-4"><a class="block w-full" href="/"><div class="m-auto w-32 lg:w-full"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained rounded-full mb-4"><div style="max-width:1024px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg%20height=&#x27;1024&#x27;%20width=&#x27;1024&#x27;%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#786878;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="/static/a3e20b7904612699ef962aa83aaa759b/22bfc/icon.webp 256w,/static/a3e20b7904612699ef962aa83aaa759b/d689f/icon.webp 512w,/static/a3e20b7904612699ef962aa83aaa759b/67ded/icon.webp 1024w" sizes="(min-width: 1024px) 1024px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1024px) 1024px, 100vw" decoding="async" loading="lazy" data-src="/static/a3e20b7904612699ef962aa83aaa759b/24f4c/icon.jpg" data-srcset="/static/a3e20b7904612699ef962aa83aaa759b/68974/icon.jpg 256w,/static/a3e20b7904612699ef962aa83aaa759b/3c367/icon.jpg 512w,/static/a3e20b7904612699ef962aa83aaa759b/24f4c/icon.jpg 1024w" alt="pixel art portrait"/></picture><noscript><picture><source type="image/webp" srcSet="/static/a3e20b7904612699ef962aa83aaa759b/22bfc/icon.webp 256w,/static/a3e20b7904612699ef962aa83aaa759b/d689f/icon.webp 512w,/static/a3e20b7904612699ef962aa83aaa759b/67ded/icon.webp 1024w" sizes="(min-width: 1024px) 1024px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1024px) 1024px, 100vw" decoding="async" loading="lazy" src="/static/a3e20b7904612699ef962aa83aaa759b/24f4c/icon.jpg" srcSet="/static/a3e20b7904612699ef962aa83aaa759b/68974/icon.jpg 256w,/static/a3e20b7904612699ef962aa83aaa759b/3c367/icon.jpg 512w,/static/a3e20b7904612699ef962aa83aaa759b/24f4c/icon.jpg 1024w" alt="pixel art portrait"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></div></a><ul class="flex justify-between"><li><a class="hover:underline" href="mailto:ianlondondu@gmail.com">Email</a></li><li><a class="hover:underline" href="https://linkedin.com/in/ianlondon">LinkedIn</a></li><li><a class="hover:underline" href="https://github.com/IanLondon">GitHub</a></li></ul></section></aside><article class="w-full p-3 lg:basis-3/4 lg:m-auto lg:max-w-4xl"><h1 class="text-3xl">VBoW Pt 2 - Image Classification in Python with Visual Bag of Words (VBoW)</h1><p class="mb-4">May 11, 2016</p><div class="markdown"><h1>Image Classification in Python with Visual Bag of Words (VBoW)</h1>
<p><a href="../how-to-sift-opencv-vbow-part-1">Part 1</a></p>
<p><a href="../how-to-sift-opencv-vbow-part-2">Part 2</a></p>
<h2>Part 2: The Visual Bag of Words Model</h2>
<h3>What is a Bag of Words?</h3>
<p>In the world of natural language processing (NLP), we often want to compare multiple documents. Documents each have a bunch of different words in a certain order. We will ignore the order and just throw the words into a bag. Then we can simply count the occurences of each word in the corpus of all words. Finally, each document is converted to a histogram of word counts, and that can be used as features for machine learning.</p>
<p>We make our corpus of all words from taking the set of all the words in the all documents within our training set. The test set documents can have words that don't show up in the corpus -- those words will just be ignored. We have to do this because in order to feed data into a machine learning classifier, each observation must have the same number of features: we can't have one document with 100 features and another with 104 features.</p>
<h3>Non-standard words?</h3>
<p>On many documents we can do an exact match for words, because modern English spelling is pretty standardized. We always spell <code>herself</code> as <code>herself</code>. But if we take some Middle English from Chaucer's Canturbury Tales, we will find that <code>herself</code> is spelled <a href='http://sites.fas.harvard.edu/~chaucer/spelling.htm'>many ways:</a> hire-self, herself, herselven, hireself, hireselve, hireselven, hirself, hirselve, hirselven, hirsilf, hyreself, and hyrself.</p>
<p><em>Excerpt:</em></p>
<blockquote>
<p>The coper teyne, noght knowing this preest,<br>
And hidde it, and him hente by the breest,<br>
And to him spak, and thus seyde in his game,<br>
'Stoupeth adoun, by god, ye be to blame,<br>
Helpeth me now, as I dide yow whyl-er,<br>
Putte in your hand, and loketh what is ther.</p>
</blockquote>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/887d75b199edba889bbba72b2e2ff805/c08c5/canterbury.jpg"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 39.189189189189186%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAMB/8QAFwEAAwEAAAAAAAAAAAAAAAAAAAEDBP/aAAwDAQACEAMQAAAByhntYI//xAAZEAEAAgMAAAAAAAAAAAAAAAABAAIDERL/2gAIAQEAAQUCVtmpsnc//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGhAAAQUBAAAAAAAAAAAAAAAAAAECITFBUf/aAAgBAQAGPwJ3Fokw/8QAGhAAAgIDAAAAAAAAAAAAAAAAAAERIWGRof/aAAgBAQABPyFpQ4pdlF2fB4aH/9oADAMBAAIAAwAAABB3/wD/xAAVEQEBAAAAAAAAAAAAAAAAAAAAAf/aAAgBAwEBPxCo/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAERQf/aAAgBAgEBPxDIRH//xAAcEAEAAgIDAQAAAAAAAAAAAAABESEAkTFBYYH/2gAIAQEAAT8Qr50BIQ6217l9MvCzpiTb/Of/2Q=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Illuminated manuscript"
        title=""
        src="/static/887d75b199edba889bbba72b2e2ff805/1c72d/canterbury.jpg"
        srcset="/static/887d75b199edba889bbba72b2e2ff805/a80bd/canterbury.jpg 148w,
/static/887d75b199edba889bbba72b2e2ff805/1c91a/canterbury.jpg 295w,
/static/887d75b199edba889bbba72b2e2ff805/1c72d/canterbury.jpg 590w,
/static/887d75b199edba889bbba72b2e2ff805/c08c5/canterbury.jpg 640w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p>If we have a bunch of documents in Middle English and make a histogram of the whole corpus, we'll count <code>hirselve</code>, <code>hirsilf</code>, and <code>hyreself</code> as totally different words. It will be hard to figure out which documents are talking about women. Because spelling variation is such a big issue, we need some way to <strong>cluster</strong> all the variants of a word together so that they wind up in the same bin.</p>
<h3>"Visual words"</h3>
<p>In the <a href="../how-to-sift-opencv-vbow-part-1">previous post</a> I explained what SIFT descriptors are and how to generate them. If we think of every picture as a document of SIFT "words", we can extend the bag of words model to classify images instead of text documents. We might imagine that one SIFT descriptor "visual word" represents an octopus eye, another one represents a tentacle "suction cup", and so on.</p>
<p>These visual words have spelling variations, just like Middle English, so we have to have some clustering method to bin together the words that represent the same thing. All the eye features should go to the same bin, all the tentacle suckers in their own bin. It's more intuitive to think of the bins as being <strong>codewords</strong> like "eye features" and "tentacle features".</p>
<p>However, SIFT features are not so literal as "octopus eye", they tend to represent something more like "bright blob which gradually blends into darkish blob with a diagonal oblong midtone blob". We can't bin them together based on some human-meaningful definition. But we can bin them together mathematically. SIFT descriptors are 128-dimensional vectors, so we can simply make a matrix with every SIFT descriptor in our training set as its own row, and 128 columns for each of the dimensions of the SIFT features. Plug that matrix to a clustering algorithm like KMeans, then get the descriptors clustered into K different codewords (ie, K different clusters, or K different bins).</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/5e49e1758d181dc061fcb75b3a25c4f7/a2510/octo_vbow_bag.jpg"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 64.86486486486486%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIFBP/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAFLeCjDih//xAAbEAEAAgIDAAAAAAAAAAAAAAABAAIRIRITFP/aAAgBAQABBQK1nvXRYmH0Nd8Cf//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/AWf/xAAcEAABAwUAAAAAAAAAAAAAAAARABBRARIiMTL/2gAIAQEABj8CvFOpUsDidBEt/8QAGhAAAgMBAQAAAAAAAAAAAAAAAAERIUExof/aAAgBAQABPyGW5pRvwZZLHBjVVD4/xCgjUJeH/9oADAMBAAIAAwAAABD0P//EABURAQEAAAAAAAAAAAAAAAAAAAAh/9oACAEDAQE/EEf/xAAXEQADAQAAAAAAAAAAAAAAAAAAAREh/9oACAECAQE/EKawVP/EAB0QAQEAAgIDAQAAAAAAAAAAAAERACExUUGR4fD/2gAIAQEAAT8QeIg9jY0Xp9xItaIu5fWAJuVF84ggKXZY4uMCVcd/pgXEu9Ez/9k='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="bag of visual words diagram"
        title=""
        src="/static/5e49e1758d181dc061fcb75b3a25c4f7/1c72d/octo_vbow_bag.jpg"
        srcset="/static/5e49e1758d181dc061fcb75b3a25c4f7/a80bd/octo_vbow_bag.jpg 148w,
/static/5e49e1758d181dc061fcb75b3a25c4f7/1c91a/octo_vbow_bag.jpg 295w,
/static/5e49e1758d181dc061fcb75b3a25c4f7/1c72d/octo_vbow_bag.jpg 590w,
/static/5e49e1758d181dc061fcb75b3a25c4f7/a8a14/octo_vbow_bag.jpg 885w,
/static/5e49e1758d181dc061fcb75b3a25c4f7/a2510/octo_vbow_bag.jpg 1000w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p>Next we go through each individual image, and assign all of its SIFT descriptors to the bin they belong in. All the "eye" SIFT descriptors will be converted from a 128-dimensional SIFT vector to a bin label like "eye" or "Bin number 4". Finally we make a histogram for each image by summing the number of features for each codeword. For example, with K=3, we might get a total of 1 eye feature, 3 tentacle features, and 5 tentacle sucker features for image number 1; a different distribution for image number 2, and so on. (Remember, this is just a metaphor: real SIFT feature clusters won't have such a human-meaningful definition.)</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/12bf94a76bc07152a07fd33f88f8173c/b54c8/octo_histogram.jpg"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIDBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABXpaqCFRP/8QAGhAAAgIDAAAAAAAAAAAAAAAAAQIAAwQxQf/aAAgBAQABBQJrrAaXc46To1P/xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAwEBPwFn/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAHBAAAQQDAQAAAAAAAAAAAAAAAQACITEgIiNx/9oACAEBAAY/AndTdIE7OmU73D//xAAaEAACAgMAAAAAAAAAAAAAAAABEQAhEEGR/9oACAEBAAE/Ib3CCSCocKguozYvWHI//9oADAMBAAIAAwAAABD0H//EABcRAAMBAAAAAAAAAAAAAAAAAAABESH/2gAIAQMBAT8Q0oJQ/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHRAAAgIBBQAAAAAAAAAAAAAAAREAITEQQWGBsf/aAAgBAQABPxAmkREiMra4I2RwQikGOPJemBrFoIVM3cxaf//Z'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="bag of visual words histogram"
        title=""
        src="/static/12bf94a76bc07152a07fd33f88f8173c/1c72d/octo_histogram.jpg"
        srcset="/static/12bf94a76bc07152a07fd33f88f8173c/a80bd/octo_histogram.jpg 148w,
/static/12bf94a76bc07152a07fd33f88f8173c/1c91a/octo_histogram.jpg 295w,
/static/12bf94a76bc07152a07fd33f88f8173c/1c72d/octo_histogram.jpg 590w,
/static/12bf94a76bc07152a07fd33f88f8173c/b54c8/octo_histogram.jpg 879w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<div style='text-align: center;'>Image 1 --> <code>[1, 3, 5]</code></div>
<p>At this point we have converted images with varying numbers of SIFT features into K features. We can feed the matrix of M observations and K features into a classifier like AdaBoost or SVC as our <code>X</code>, image labels as our <code>y</code>, and it ought to be able to predict image labels from images with some degree of accuracy.</p>
<h3>But what is K? How many bins do we need?</h3>
<p>For my panda detector project I performed a <strong>grid search</strong> across a range of K values and compared the scores of classifiers for each K. My grid search code is <a href="https://github.com/IanLondon/general_img_classifier/blob/master/K_grid_search.py">on GitHub</a> and references other files in <a href="https://github.com/IanLondon/general_img_classifier">the repo</a>.</p>
<p>Determining what K to use for K-means <a href="https://en.wikipedia.org/wiki/Determining_the_number_of_clusters_in_a_data_set">is an art, not a science</a>, so depending on your project (and how long it takes to do a grid search) you might want to try different methods.</p></div></article></section><a href="/"><p class="text-center w-full my-4 py-2 bg-amber-950 hover:bg-amber-900 hover:font-bold">Back</p></a><footer class="text-center italic">Â©<!-- -->2024<!-- --> Ian London</footer></main></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/posts/how-to-sift-opencv-vbow-part-2/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-25f52c5e9048763baf3b.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-82e7c72e1e3649cbc05f.js\"],\"component---src-pages-about-tsx\":[\"/component---src-pages-about-tsx-071b38ebf1e62ab6373c.js\"],\"component---src-pages-index-tsx\":[\"/component---src-pages-index-tsx-8d58d8f51b2997221e20.js\"],\"component---src-pages-posts-markdown-remark-frontmatter-slug-tsx\":[\"/component---src-pages-posts-markdown-remark-frontmatter-slug-tsx-797c4d69d3db40702916.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="1d81265fb4fa6882fc34";</script><script src="/webpack-runtime-d6dac978abe15429bcb4.js" async></script><script src="/framework-39cfd3f0ffbe436ed19e.js" async></script><script src="/app-25f52c5e9048763baf3b.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>